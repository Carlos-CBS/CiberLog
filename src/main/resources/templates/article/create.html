<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"><title>Create Article</title></head>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simplemde/1.11.2/simplemde.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css" />

<link rel="stylesheet" href="/css/createBlog.css">

<!-- Scripts externos -->
<script src="https://cdn.jsdelivr.net/npm/commonmark@0.30.0/dist/commonmark.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/simplemde/1.11.2/simplemde.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>

<body>
<h1>Create Article</h1>
<a href="/article/list"><button>Back to List</button></a>

<form th:action="@{/article/create}"
      th:object="${article}"
      method="post"
      id="blogForm">

    <label>Title</label>
    <input th:field="*{title}" type="text" required/>

    <label>Slug (opt.)</label>
    <input th:field="*{slug}" type="text"/>

    <label>Collection</label>
    <select th:field="*{collection.id}" required>
        <!-- aquí usamos value="" normal -->
        <option value="">-- select --</option>
        <option th:each="c : ${collections}"
                th:value="${c.id}"
                th:text="${c.title}">
        </option>
    </select>

    <label>Summary</label>
    <textarea th:field="*{summary}" required></textarea>

    <label>Reading time (minutes)</label>
    <input th:field="*{reading_time_minutes}"
           type="number" min="1" required/>

    <label>Status</label>
    <select th:field="*{status}">
        <option value="draft">draft</option>
        <option value="review">review</option>
        <option value="published">published</option>
    </select>

    <label>Difficulty</label>
    <select th:field="*{difficulty}">
        <option value="basic">basic</option>
        <option value="intermediate">intermediate</option>
        <option value="advanced">advanced</option>
    </select>

    <label>Tags</label>
    <div>
        <div th:each="tag : ${allTags}">
            <label>
                <input type="checkbox" th:value="${tag.id}"
                       th:field="*{tags}" />
                <span th:text="${tag.name}">TagName</span>
            </label>
        </div>
    </div>

    <div class="form-group">
        <label>Plantillas:</label>
        <div class="templates">
            <button type="button" class="template-btn" data-template="vulnerability">Análisis de Vulnerabilidad</button>
            <button type="button" class="template-btn" data-template="tutorial">Tutorial Técnico</button>
            <button type="button" class="template-btn" data-template="news">Noticia de Seguridad</button>
            <button type="button" class="template-btn" data-template="poc">Prueba de Concepto</button>
        </div>

        <div class="form-group">
            <label for="markdown-editor">Contenido (Markdown):</label>
            <textarea id="markdown-editor" th:field="*{content}" placeholder="Escribe tu blog en Markdown aquí" rows="12"></textarea>
        </div>
    <button type="submit">Create</button>
    </div>
</form>

<script src="/js/createBlog.js" defer></script>
<script src="/js/createBlogPlantillas.js" defer></script>
</body>
</html>
